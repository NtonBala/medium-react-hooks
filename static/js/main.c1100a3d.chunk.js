(this["webpackJsonpmedium-react-hooks"]=this["webpackJsonpmedium-react-hooks"]||[]).push([[0],{33:function(e,t,a){e.exports=a(51)},51:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(25),l=a.n(r),o=a(5),s=a(21),i=a(13),m=a(32);s.a.use(m.a).use(i.e).init({debug:!0,fallbackLng:"en",interpolation:{escapeValue:!1},resources:{en:{translation:{common:{email:"Email",signIn:"Sign in",signUp:"Sign up",home:"Home",password:"Password",username:"Username",newPost:"New Post",loading:"Loading..."},auth:{needAccount:"Need an account?",haveAccount:"Have an account?"},globalFeed:{title:"Global Feed",bannerTitle:"Medium clone",bannerDescription:"A place to share knowledge."},article:{title:"Article",readMore:"Read more..."},errors:{common:"Some error happened"}}}}});s.a;var u=a(3),d=a(54),b=Object.freeze({main:"/",article:"/article",articles:"/articles",login:"/login",register:"/register",newArticle:"/articles/new",profiles:"/profiles"}),g=a(4),E=function(){var e=Object(d.a)().t;return c.a.createElement("div",null,e("article.title"))},p=a(6),f=a(53),v=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),c=a[0],r=a[1],l=Object(n.useState)(null),o=Object(u.a)(l,2),s=o[0],i=o[1],m=Object(n.useState)(null),d=Object(u.a)(m,2),b=d[0],g=d[1],E=Object(n.useState)({}),v=Object(u.a)(E,2),O=v[0],h=v[1],N=j("token"),k=Object(u.a)(N,1)[0],x=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(e),r(!0)}),[]);return Object(n.useEffect)((function(){if(c){var t=Object(p.a)(Object(p.a)({},O),{},{headers:{authorization:k?"Token ".concat(k):""}});Object(f.a)("https://conduit.productionready.io/api"+e,t).then((function(e){i(e.data)})).catch((function(e){g(e.response.data)})).finally((function(){r(!1)}))}}),[c,O,k,e]),[{isLoading:c,response:s,error:b},x]},j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=Object(n.useState)((function(){return localStorage.getItem(e)||t})),c=Object(u.a)(a,2),r=c[0],l=c[1];return Object(n.useEffect)((function(){localStorage.setItem(e,r)}),[e,r]),[r,l]},O=Object.freeze({login:"/users/login",register:"/users",currentUser:"/user",articles:"/articles"}),h=function(){var e=Object(d.a)().t,t="".concat(O.articles,"?limit=10&offset=0"),a=v(t),r=Object(u.a)(a,2),l=r[0],o=l.response,s=l.isLoading,i=l.error,m=r[1];return Object(n.useEffect)((function(){m()}),[m]),c.a.createElement("div",{className:"home-page"},c.a.createElement("div",{className:"banner"},c.a.createElement("div",{className:"container"},c.a.createElement("h1",null,e("globalFeed.bannerTitle")),c.a.createElement("p",null,e("globalFeed.bannerDescription")))),c.a.createElement("div",{className:"container page"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-9"},s&&c.a.createElement("div",null,e("common.loading")),i&&c.a.createElement("div",null,e("errors.common")),!s&&o&&c.a.createElement(I,{articles:o.articles})),c.a.createElement("div",{className:"col-md-3"},"Popular tags"))))},N=Object(n.createContext)([{},function(){}]),k=function(e){var t=e.children,a=Object(n.useState)({isLoading:!1,isLoggedIn:null,currentUser:null}),r=Object(u.a)(a,2),l=r[0],o=r[1];return c.a.createElement(N.Provider,{value:[l,o]},t)},x=function(e){var t=Object(d.a)().t,a=e.match.path===b.login,r=t(a?"common.signIn":"common.signUp"),l=a?b.register:b.login,s=t(a?"auth.needAccount":"auth.haveAccount"),i=a?O.login:O.register,m=v(i),E=Object(u.a)(m,2),f=E[0],h=f.isLoading,k=f.response,x=f.error,w=E[1],S=Object(n.useState)(""),L=Object(u.a)(S,2),I=L[0],U=L[1],A=Object(n.useState)(""),C=Object(u.a)(A,2),F=C[0],P=C[1],M=Object(n.useState)(""),z=Object(u.a)(M,2),D=z[0],T=z[1],H=Object(n.useState)(!1),J=Object(u.a)(H,2),B=J[0],G=J[1],R=j("token"),V=Object(u.a)(R,2)[1],q=Object(n.useContext)(N),K=Object(u.a)(q,2)[1];return Object(n.useEffect)((function(){k&&(V(k.user.token),G(!0),K((function(e){return Object(p.a)(Object(p.a)({},e),{},{isLoggedIn:!0,isLoading:!1,currentUser:k.user})})))}),[k,K,V]),B?c.a.createElement(g.a,{to:b.main}):c.a.createElement("div",{className:"auth-page"},c.a.createElement("div",{className:"container page"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-6 offset-md-3 col-xs-12"},c.a.createElement("h2",{className:"text-xs-center"},r),c.a.createElement("p",{className:"text-xs-center"},c.a.createElement(o.b,{to:l},s)),c.a.createElement("form",{onSubmit:function(e){var t=a?{email:I,password:F}:{username:D,email:I,password:F};e.preventDefault(),K((function(e){return Object(p.a)(Object(p.a)({},e),{},{isLoading:!0})})),w({method:"post",data:{user:t}})}},x&&c.a.createElement(y,{backendErrors:x.errors}),c.a.createElement("fieldset",null,!a&&c.a.createElement("fieldset",{className:"form-group"},c.a.createElement("input",{className:"form-control form-control-lg",type:"text",placeholder:t("common.username"),value:D,onChange:function(e){return T(e.target.value)}})),c.a.createElement("fieldset",{className:"form-group"},c.a.createElement("input",{className:"form-control form-control-lg",type:"email",placeholder:t("common.email"),value:I,onChange:function(e){return U(e.target.value)}})),c.a.createElement("fieldset",{className:"form-group"},c.a.createElement("input",{className:"form-control form-control-lg",type:"password",placeholder:t("common.password"),value:F,onChange:function(e){return P(e.target.value)}})),c.a.createElement("button",{className:"btn btn-lg btn-primary pull-xs-right",type:"submit",disabled:h},r)))))))},w=function(){return c.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"200px 0"}},c.a.createElement("h2",null,"Page Not Found"))},S=function(){return c.a.createElement(g.d,null,c.a.createElement(g.b,{path:b.main,component:h,exact:!0}),c.a.createElement(g.b,{path:b.login,component:x,exact:!0}),c.a.createElement(g.b,{path:b.register,component:x,exact:!0}),c.a.createElement(g.b,{path:"".concat(b.articles,"/:slug"),component:E,exact:!0}),!1,c.a.createElement(g.b,{path:"*",component:w}))},L=function(){var e=Object(d.a)().t,t=Object(n.useContext)(N),a=Object(u.a)(t,1)[0],r=a.isLoggedIn,l=a.currentUser;return c.a.createElement("nav",{className:"navbar navbar-light"},c.a.createElement("div",{className:"container"},c.a.createElement("h1",null,c.a.createElement(o.b,{to:b.main,className:"navbar-brand"},"Medium")),c.a.createElement("ul",{className:"nav navbar-nav pull-xs-right"},c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.c,{exact:!0,to:b.main,className:"nav-link"},e("common.home"))),!1===r&&c.a.createElement(c.a.Fragment,null,c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.c,{to:b.login,className:"nav-link"},e("common.signIn"))),c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.c,{to:b.register,className:"nav-link"},e("common.signUp")))),r&&c.a.createElement(c.a.Fragment,null,c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.c,{to:b.newArticle,className:"nav-link"},c.a.createElement("i",{className:"ion-compose"}),"\xa0 ",e("common.newPost"))),c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.c,{to:"".concat(b.profiles,"/").concat(l.username),className:"nav-link"},c.a.createElement("img",{className:"user-pic",src:l.image,alt:""}),"\xa0 ",l.username))))))},y=function(e){var t=e.backendErrors,a=Object.entries(t).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return"".concat(a," ").concat(n.join(" "))}));return c.a.createElement("ul",{className:"error-messages"},a.map((function(e){return c.a.createElement("li",{key:e},e)})))},I=function(e){var t=e.articles,a=Object(d.a)().t;return c.a.createElement("div",null,t.map((function(e,t){var n=e.author,r=e.createdAt,l=e.slug,s=e.title,i=e.description,m=e.tagList;return c.a.createElement("div",{key:t,className:"article-preview"},c.a.createElement("div",{className:"article-meta"},c.a.createElement(o.b,{to:"".concat(b.profiles,"/").concat(n.username)},c.a.createElement("img",{src:n.image,alt:""})),c.a.createElement("div",{className:"info"},c.a.createElement(o.b,{to:"".concat(b.profiles,"/").concat(n.username),className:"author"},n.username),c.a.createElement("span",{className:"date"},r))),c.a.createElement(o.b,{to:"".concat(b.article,"/").concat(l),className:"preview-link"},c.a.createElement("h1",null,s),c.a.createElement("p",null,i),c.a.createElement("span",null,a("article.readMore")),c.a.createElement("ul",{className:"tag-list"},m.map((function(e){return c.a.createElement("li",{key:e,className:"tag-default tag-pill tag-outline"},e)})))))})))},U=function(e){var t=e.children,a=v(O.currentUser),c=Object(u.a)(a,2),r=c[0].response,l=c[1],o=Object(n.useContext)(N),s=Object(u.a)(o,2)[1],i=j("token"),m=Object(u.a)(i,1)[0];return Object(n.useEffect)((function(){m?(s((function(e){return Object(p.a)(Object(p.a)({},e),{},{isLoading:!0})})),l()):s((function(e){return Object(p.a)(Object(p.a)({},e),{},{isLoggedIn:!1})}))}),[s,l,m]),Object(n.useEffect)((function(){r&&s((function(e){return Object(p.a)(Object(p.a)({},e),{},{currentUser:r.user,isLoading:!1,isLoggedIn:!0})}))}),[r,s]),t},A=o.a,C=function(){return c.a.createElement(k,null,c.a.createElement(U,null,c.a.createElement(A,null,c.a.createElement(L,null),c.a.createElement(S,null))))};l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(C,null)),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.c1100a3d.chunk.js.map